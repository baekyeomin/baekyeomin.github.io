---
title: "[ML] 7. SVM (Support Vector Machine) "
categories: [AI, ML]
tags:
  - λ¨Έμ‹ λ¬λ‹
  - μ§€λ„ν•™μµ
layout: single
toc : true
toc_sticky: true
comments: true
use_math: true
---

κµ­λ―Όλ€ κΉ€μ¥νΈ κµμλ‹ "λ¨Έμ‹ λ¬λ‹κΈ°μ΄" κ³Όλ©(2ν•™λ…„ 1ν•™κΈ° μκ°•)μ„ λ°”νƒ•μΌλ΅ ν•™μµν• λ‚΄μ©μ„ μ •λ¦¬ν• κΈ€μ…λ‹λ‹¤.
{: .notice--info}

## SVM
- <span style="color: blue">μ§€λ„ν•™μµ</span> μ•κ³ λ¦¬μ¦ μ¤‘ ν•λ‚
- <span style="color: blue">λ¶„λ¥(classification)</span>μ— μ£Όλ΅ μ‚¬μ©
- μ£Όμ–΄μ§„ λ°μ΄ν„° ν¬μΈνΈλ¥Ό κ°€λ¥ν• ν• μ κµ¬λ¶„ν•  μ μλ” <span style="background-color: #fff3cd">decision boundary (= λ‘ classλ¥Ό λ¶„λ¦¬ν•λ” μ„ μ΄λ‚ μ΄ν‰λ©΄)μ„ μ°Ύλ” κ²ƒμ΄ ν•µμ‹¬ μ•„μ΄λ””μ–΄ !</span>
  - μµλ€ λ§μ§„μ„ κ°€μ§€λ„λ΅ν•κΈ° 
    - λ§μ§„ : decision boundaryμ™€ κ°€μ¥ κ°€κΉμ΄ λ°μ΄ν„° ν¬μΈνΈ (=support vector) μ‚¬μ΄ κ±°λ¦¬
    - <span style="background-color: #fff3cd">λ§μ§„μ΄ ν΄μλ΅ μƒ λ°μ΄ν„° ν¬μΈνΈμ— λ€ν•΄ λ” μ μΌλ°ν™” λ  κ°€λ¥μ„±μ΄ ν¬λ‹¤!</span>
- λ‹¤μ¤‘ λ¶„λ¥λ” `one-vs-all` λλ” `one-vs-one` μ „λµμΌλ΅ ν™•μ¥
<br>

> ## κ²°μ • κ²½κ³„μ™€ λ§μ§„ (μ„ ν• λ¶„λ¦¬ κ°€μ •)
> - **κ²°μ • κ²½κ³„(Decision Boundary)**:  
>   $\theta^T x + b = 0$
> 
> - **λ‘ λ§μ§„ κ²½κ³„**:  
>   $\theta^T x + b = \pm 1$
> 
> - **λ§μ§„ ν­ (Margin Width)**:  
>   $\text{margin width} = \frac{2}{\|\theta\|}$
> - **μ„ν¬νΈ λ²΅ν„°(Support Vector)**:  
>   λ§μ§„ κ²½κ³„(=\(\pm1\))μ— **λ‹Ώμ•„ μλ” μ λ“¤**.  

<br>
<br>
<br>

## λ΅μ§€μ¤ν‹± νκ·€μ™€ λΉ„κµ
### πΎ [λ΅μ§€μ¤ν‹± νκ·€] μ†μ‹¤ν•¨μ
<br>
<span style="background-color: #fff3cd"><u> μ΄μ§„ ν¬λ΅μ¤ μ—”νΈλ΅ν”Ό </u> </span> <br>
$J(\theta) = -\frac{1}{m}\sum_{i=1}^m \Big[y^{(i)}\log h_\theta(x^{(i)}) + \big(1-y^{(i)}\big)\log \big(1-h_\theta(x^{(i)})\big)\Big]$
- y=1μΌ λ• : $z=\theta^Tx$κ°€ **ν΄μλ΅** μ†μ‹¤ β†“
- y=0μΌ λ• : $z=\theta^Tx$κ°€ **μ‘μ„μλ΅** μ†μ‹¤ β†“

### πΎ [SVM] μ†μ‹¤ν•¨μ
![kmeans ν΄λ¬μ¤ν„°λ§ κ·Έλ¦Ό](/assets/images/hingeloss.png)  
<br>
<span style="background-color: #fff3cd"> <u> Hinge Loss </u>  </span> <br>
$\ell\big(y, f(x)\big)=\max\big(0,\, 1 - y\cdot f(x)\big),\quad f(x)=\theta^T x + b$
<br>
μ—¬κΈ°μ„ $y \in \{-1, +1\}$ μ΄κΈ°μ— λ¶€νΈκ°€ μΌμΉν•λ©΄ μ†μ‹¤ = 0
- λ§μ§„μ€ μ†μ‹¤μ ν¬κΈ°κ°€ ν΄μλ΅ μ‘λ‹¤. 
  - λ§μ§„μ΄ ν¬λ‹¤λ” κ²ƒμ€ λ°μ΄ν„°κ°€ κ²°μ • κ²½κ³„μ—μ„ λ©€λ¦¬ λ–¨μ–΄μ Έ μλ‹¤λ” λ»μ΄κΈ°μ— λ¶„λ¥κ°€ ν™•μ‹¤ν•κ² μ λμ—λ‹¤λ” λ»μ΄κΈ° λ•λ¬Έ !
  
<span style="background-color: #fff3cd"><u> μ†μ‹¤ν•¨μ </u> </span> <br>
$\min_{\theta,b}\; \frac{1}{2}\|\theta\|^2 \;+\; C\sum_{i=1}^m \max\big(0,\,1-y_i(\theta^T x_i+b)\big)$
<br>
- μ²« λ²μ§Έ ν•­:  
  $\tfrac{1}{2}\|\theta\|^2$ β†’ **λ§μ§„ μµλ€ν™”** ν¨κ³Ό (κ°€μ¤‘μΉλ¥Ό μ‘κ² μ μ§€).
- λ‘ λ²μ§Έ ν•­:  
  $C\sum \max(0,1-y_i(\theta^T x_i+b))$ β†’ **νμ§€ λ΅μ¤ ν•©** (μ¤λ¶„λ¥/μ‘μ€ λ§μ§„μ— λ€ν• νλ„ν‹°).
- C: μ¤λ¶„λ¥λ¥Ό μ–Όλ§λ‚ ν—μ©ν• μ§€ μ΅°μ ν•λ” ν•μ΄νΌνλΌλ―Έν„°
  - Cκ°’ ν¬λ©΄ β†’ μ¤λ¶„λ¥λ¥Ό κ±°μ ν—μ© μ• ν•¨ (λ¶„μ‚°β†‘, κ³Όμ ν•© μ„ν—).
  - Cκ°’ μ‘μΌλ©΄ β†’ μ¤λ¶„λ¥λ¥Ό ν—μ© (νΈν–¥β†‘, κ³Όμ†μ ν•© μ„ν—).


> **νμ§€ λ΅μ¤**: λ°μ΄ν„° ν• μ μ— λ€ν• μ†μ‹¤
> **SVM μ†μ‹¤ν•¨μ**:  
>  - **μ •κ·ν™” ν•­ (λ§μ§„ κ΄€λ ¨)** + **νμ§€ λ΅μ¤ ν•©**  
>   - μ¦‰, **νμ§€ λ΅μ¤λ¥Ό μµμ†ν™”ν•λ©΄μ„ λ§μ§„μ€ ν¬κ² ν•λ” κ²ƒμ΄ ν•µμ‹¬**
>
> $\min_{\theta,b}\; \frac{1}{2}\|\theta\|^2 + C \sum \text{νμ§€λ΅μ¤}$

<br>
<br>
<br>

## μν•™μ μΌλ΅ λ³Έ SVM 
λ§μ§„μ„ κµ¬ν•  λ• λ²΅ν„°μ λ‚΄μ μ΄λ‚ μ •μ‚¬μμ κ°λ…μ„ μ•μ•„λ‘μ–΄μ•Όν•λ‹¤. 
ν•΄λ‹Ή λ‚΄μ©μ€ μ•„λ λ…ΈνΈν•„κΈ° μ‚¬μ§„ μ°Έκ³ ν•κΈ° !
![svm_math](/assets/images/svm_math.png)  

<br>
<br>
<br>

### SVM μ»¤λ„ νΈλ¦­
### πΎ μ»¤λ„νΈλ¦­ ν•„μ” μ΄μ 
λ‹¨μν• μ„ ν• κ²°μ • κ²½κ³„λ΅λ” λ¶„λ¥ λ¶κ°€ν• κ²½μ°, <br>
λΉ„μ„ ν• λ°μ΄ν„°λ¥Ό μ„ ν•μ μΌλ΅ κµ¬λ¶„ν•  μ μκ² νΉμ„±λ³€ν™μ΄ ν•„μ”ν•λ‹¤!

### πΎ μ»¤λ„ νΈλ¦­ (Kernel Trick)
xμ— λ€ν•΄ λλ“λ§ν¬μ™€μ μ μ‚¬λ„ κΈ°λ°μΌλ΅ μƒλ΅μ΄ νΉμ§•λ²΅ν„°λ¥Ό κ³„μ‚°ν•λ” κ³Όμ •

1. μ£Όμ–΄μ§„ λ°μ΄ν„°κ°€ μμ
2. λλ“λ§ν¬λ¥Ό μ§€μ •ν•¨
3. μ μ‚¬λ„λ¥Ό κ³„μ‚°ν•¨
4. ν›λ ¨λ°μ΄ν„°μ— λ€ν•΄ μ μ‚¬λ„ λ²΅ν„° κ³„μ‚°
$f(x) = [K(x,l^{(1)}), K(x,l^{(2)}), \dots, K(x,l^{(m)})]$ <br>
-> μ΄ κ³Όμ •μ„ ν†µν•΄ λ°μ΄ν„° μ°¨μ› ν™•μ¥, $x^i$λ” κ³ μ°¨μ› κ³µκ°„μΌλ΅ λ§¤ν•‘

- μ§μ ‘ κ³ μ°¨μ›μΌλ΅ λ§¤ν•‘ν•μ§€ μ•κ³ , **λ‚΄μ **μ„ ν†µν•΄ κ³„μ‚°
- $K(x,z)=\phi(x)\cdot\phi(z)$
- λ‹¤μ–‘ν• μ»¤λ„(μ„ ν• μ»¤λ„, string μ»¤λ„, chi-square μ»¤λ„.. λ“±) μ΄ μμ§€λ§, λ¨Έμ‹ λ¬λ‹κΈ°μ΄ κ³Όλ©μ—μ„λ” κ°€μ°μ‹μ• μ»¤λ„λ§ μ§κ³  λ„μ–΄κ°
  
<span style="background-color: #fff3cd"><u> κ°€μ°μ‹μ• μ»¤λ„ </u> </span> <br>

$K(x,z)=\exp\left(-\frac{\|x-z\|^2}{2\sigma^2}\right)$

- λ‘ λ²΅ν„°μ κ±°λ¦¬κ°€ κ°€κΉμ°λ©΄ κ°’μ΄ 1, λ©€μ–΄μ§€λ©΄ 0μ— κ°€κΉμ›μ§
- $f_i(x)=\exp\left(-\frac{(x-l^{(i)})^2}{2\sigma^2}\right)$ μ—μ„ $l^i$λ” κΈ°μ¤€μ (λλ“λ§ν¬), xλ” μ…λ ¥λ°μ΄ν„°
- $\sigma^2$ (λ¶„μ‚°) μ΄ μ‘μΌλ©΄ sharp peak, ν¬λ©΄ λ„“κ² νΌμ§
- λλ“λ§ν¬ μ„ νƒμ€
  - λλ¤ μ„ νƒ
  - λ°μ΄ν„° λ¶„ν¬ κΈ°λ° μ„ νƒ ...


<span style="background-color: #fff3cd"><u> $C$μ™€ $\sigma$μ μν–¥ </u> </span> <br>
- $C$: μ¤λ¶„λ¥ ν—μ© μ •λ„  
  - $C\uparrow$ β†’ μ¤λ¶„λ¥ μµμ†ν™”, κ³Όμ ν•© μ„ν—β†‘  
  - $C\downarrow$ β†’ μ¤λ¶„λ¥ ν—μ©, κ³Όμ†μ ν•© μ„ν—β†‘  

- $\sigma$: μ»¤λ„μ λ²”μ„ μ΅°μ   
  - $\sigma$ μ‘μΌλ©΄ β†’ κ°λ³„ ν¬μΈνΈμ— λ―Όκ° (varianceβ†‘, κ³Όμ ν•© μ„ν—β†‘)  
  - $\sigma$ ν¬λ©΄ β†’ λ°μ΄ν„° μ „μ²΄μ— μ™„λ§ (biasβ†‘, κ³Όμ†μ ν•© μ„ν—β†‘) 
<br>
<span style="color = red"> $\sigma$μ™€ $C$ κ°™μ€ ν•μ΄νΌνλΌλ―Έν„° μ„ νƒμ΄ μ¤‘μ”. </span>

<br>

    κ°μΈ κ³µλ¶€ κΈ°λ΅μ© λΈ”λ΅κ·Έμ…λ‹λ‹¤.
    μ¤λ¥λ‚ ν‹€λ¦° λ¶€λ¶„μ΄ μμ„ κ²½μ° μ–Έμ λ“ μ§€ κΈ€μ΄λ‚ λ©”μΌλ΅ μ§€μ ν•΄μ£Όμ‹λ©΄ κ°μ‚¬ν•κ² μµλ‹λ‹¤! βΊ

[λ§¨ μ„λ΅ μ΄λ™ν•κΈ°](#){: .btn .btn--primary }{: .align-right}