---
title: "[ML] 9. 차원 축소 및 PCA"
categories: [AI, ML]
tags:
  - 머신러닝
  - 지도학습
layout: single
toc : true
toc_sticky: true
comments: true
use_math: true
---

국민대 김장호 교수님 "머신러닝기초" 과목(2학년 1학기 수강)을 바탕으로 학습한 내용을 정리한 글입니다.
{: .notice--info}

## 차원 축소 (Dimensionality Reduction)
복잡하고 고차원인 데이터를 단순화하는 방법
<br>

> clustering도 복잡한 데이터를 단순화하기 위해 쓰이나, clustering은 범주형 요약, Dimensionality Reduction은 실수 벡터로의 요약

<u> 예시 </u>  </span> 
- 2D → 1D
    - 데이터 $(x_1, x_2)$를 특정 축(방향 벡터 $w$)으로 사영(projection)하여 $z_1$로 표현
- 3D → 2D
  - 데이터 $(x_1, x_2, x_3)$를 2차원 평면에 투영
  
![배깅예시](/assets/images/차원축소.png)
이해를 돕기위해 노트 필기도 첨부합니당

<br>
<br>
<br>

## PCA (Principal Component Analysis)
### 🐾 목표
<span style="background-color: #fff3cd">데이터의 분산이 가장 크게 나타나는 방향<(데이터의 특성을 가장 잘 살릴 수 있는 방향)으로 정사영하여 </span> 낮은 차원으로 투영하고, 이때 선택된 r개의 벡터를 통해 원래 데이터의 분산을 최대한 보존하는 저차원 표현(축)을 찾는 것


### 🐾 데이터의 평균 벡터 u와 공분산 구하기
- 평균 벡터 u(분산) : 각 feature에 대한 평균값
  - $Var(x) = \frac{1}{N} \sum_{i=1}^N (x_i - \mu)^2$
- 공분산 : 두 변수 간의 관계 측정 (2개 이상의 변수 필요)
  - $ Cov(X, Y) = \frac{1}{N} \sum_{i=1}^N (x_i - \mu_X)(y_i - \mu_Y)$
- 공분산 행렬 : $C = E[(x - \mu)(x - \mu)^T]$
- 상관 계수 행렬 : $\rho_{XY} = \frac{Cov(X, Y)}{\sigma_X \sigma_Y}$, 정규화한 형태이기에 상관계수의 범위는 -1~+1
  

### 🐾 공분산 행렬에 대해 고유값과 고유벡터(Eigenvalue & Eigenvector) 구하기
행렬 $A$에 대해 다음을 만족하는 $z$와 $\lambda$가 존재할 때: <br>
<span style="font-size:200%">$Az = \lambda z$</span>
- $\lambda$: 고유값 (scalar, 0 가능)  
    $\det(A - \lambda I) = 0$ 의 해를 풀어 $\lambda$를 찾는다.
- $z$: 고유벡터 (vector, 0 불가)
    각 고유값 $\lambda$에 대해 $(A - \lambda I)z = 0$ 을 풀어 대응하는 고유벡터 $z$를 구한다


### 🐾 고유값이 높은 r개의 고유벡터 선택
가장 큰 고유값 (가장 큰 분산)과 연결된 축은 우리가 만든 저차원 공간(차원 축소)의 기준축이 됨

### 🐾 원래 데이터 x를 평균 u로 중심화한 후 선택한 고유벡터 A로 투영
y = A(x-u)

### 🐾 PCA (Principal Component Analysis) 과정 정리
1. **데이터 정규화**  
   - 평균을 0, 분산을 1로 맞추어 스케일 조정  

2. **공분산 행렬 $C$ 계산**  
   $C = \frac{1}{N} X_c^T X_c$
   (여기서 $X_c$는 중심화된 데이터)

3. **고유값 분해 (Eigen Decomposition)**  
   - $C$를 고유값 $\lambda$와 고유벡터 $u$로 분해

4. **큰 고유값에 해당하는 고유벡터 선택**  
   - 분산을 가장 잘 설명하는 축(주성분) 형성

5. **데이터 투영**  
   $z = U^T (x - \mu)$


## PCA로 차원축소
쓰기 너무 귀찮아효ㅜㅜㅜ
사진 참고 ㄱㄱ
![pca](/assets/images/pca.png) 
<br>

    개인 공부 기록용 블로그입니다.
    오류나 틀린 부분이 있을 경우 언제든지 글이나 메일로 지적해주시면 감사하겠습니다! ☺

[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}